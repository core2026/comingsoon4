<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pollen Widget</title>
    <link rel="stylesheet" href="//www.pollenapps.com/df/tools/aa/css/load.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { width: 100%; height: 100%; background: #151e2e; overflow: hidden; }
        body { display: flex; justify-content: center; align-items: center; position: relative; }

        /* Loading notice â€” sits on top, fades out once widget renders */
        #loading-notice {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 12px;
            background: #151e2e;
            z-index: 10;
            transition: opacity 0.5s ease;
        }
        #loading-notice.hidden { opacity: 0; pointer-events: none; }

        .notice-icon { font-size: 2rem; animation: bounce 1.4s ease-in-out infinite; }
        @keyframes bounce {
            0%,100% { transform: translateY(0); }
            50%      { transform: translateY(-6px); }
        }
        .notice-title {
            font-family: -apple-system, 'Segoe UI', sans-serif;
            font-size: 0.9rem;
            font-weight: 700;
            color: #f8fafc;
            text-align: center;
            padding: 0 20px;
        }
        .notice-sub {
            font-family: -apple-system, 'Segoe UI', sans-serif;
            font-size: 0.72rem;
            color: #94a3b8;
            text-align: center;
            padding: 0 24px;
            line-height: 1.5;
        }
        .notice-bar {
            width: 120px;
            height: 4px;
            background: rgba(255,255,255,0.1);
            border-radius: 2px;
            overflow: hidden;
        }
        .notice-bar-fill {
            height: 100%;
            width: 40%;
            background: #38bdf8;
            border-radius: 2px;
            animation: slide 1.4s ease-in-out infinite;
        }
        @keyframes slide {
            0%   { transform: translateX(-100%); }
            100% { transform: translateX(350%); }
        }
    </style>
</head>
<body>
    <!-- Loading notice shown until widget renders -->
    <div id="loading-notice">
        <div class="notice-icon">ðŸŒ¿</div>
        <div class="notice-title">Loading Allergy Forecast...</div>
        <div class="notice-sub">A brief ad may appear first â€” your pollen data will show right after. Thank you!</div>
        <div class="notice-bar"><div class="notice-bar-fill"></div></div>
    </div>

    <div id="allergyalert" data-aa_account="10757" data-aa_location="78015"
         style="width:300px;height:250px;background-color:#eee;position:relative;display:inline-block;"></div>

    <script>
        const zip = new URLSearchParams(window.location.search).get('zip');
        if (zip) document.getElementById('allergyalert').setAttribute('data-aa_location', zip);

        // Hide the loading notice once the widget has injected content
        // Poll for the widget filling the container (it uses document.write internally)
        const notice = document.getElementById('loading-notice');
        const target = document.getElementById('allergyalert');
        let attempts = 0;
        const check = setInterval(() => {
            attempts++;
            // Widget renders a table or img inside the div
            if (target.children.length > 0 || target.innerHTML.trim().length > 10) {
                notice.classList.add('hidden');
                clearInterval(check);
            }
            // Give up after 15s â€” hide notice anyway so it doesn't block content
            if (attempts > 150) {
                notice.classList.add('hidden');
                clearInterval(check);
            }
        }, 100);
    </script>
    <script src="//www.pollenapps.com/df/tools/aa/js/one.1.0.min.js"></script>
</body>
</html>
